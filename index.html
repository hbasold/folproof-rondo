<html>
<head>
<title>Proof Rondo First-Order Logic Checker</title>
<!-- <link rel="stylesheet" href="http://getbootstrap.com/dist/css/bootstrap.min.css"> -->
<!-- <link rel="stylesheet" href="http://getbootstrap.com/assets/css/docs.min.css"> -->
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script> -->
<script src="jquery.min.js"></script>
<script type='text/javascript' src='folproof-parser.js'></script>
<script type='text/javascript' src='folproof-web.js'></script>
<script type='text/javascript' src='folproof-verifier.js'></script>
<script type='text/javascript'>
$(document).ready(function() {
	var debugMode = false;
	$("#parentheses").bind("click change", function() { $("#proof-input").keyup(); });
	$("#proof-input").keyup(function(v) {
		var proof = $(this).val();
		var paren = $("#parentheses").val();
		try {
			parser.trace = function() { if (console && console.log) console.log(arguments); };
			var ast = parser.parse(proof);
			var result = folproof.Verifier.verifyFromAST(ast);
      var resultHtml = result.message;
			if (!result.valid) {
				var str = "<p>Step: " + result.errorStep;
				if (result.errorSrcLine)
					str += ", Src Line: " + result.errorSrcLoc.first_line;
				str += "</p>";
        resultHtml += str;
				$("#result-box").css({ background: "#EFA3CD", 'border-left' : "", color : "" });
			} else {
				$("#result-box").css({ background: "#81CEB9", 'border-left' : "3px solid green", color : "" });
			}
      resultHtml += "<p>Remaining sorries: " + result.remainingSorries + "</p>";
			$("#result").html(resultHtml);
		} catch (err) {
			$("#result").html(err);
			$("#result-box").css({ background: "", 'border-left' : "", color : "" });
			//throw err;
		}
		var html = folproofWeb.render(ast, { parentheses : paren });
		$("#render-panel").empty().append(html);
	});
	$("#proof-input").keyup(); // force invocation on load
	$("button.examples").click(function() {
		var i = $(this).val();
		var proof = $("#proof-input");
		proof.val($("#example" + i).text().substr(1))
		proof.keyup();
	});
});
</script>
<style type='text/css' rel='stylesheet'>
#proof-input { height: 32em; width: 100%; font-family: monospace;}
#render-panel { height: 21em; font-family: monospace; }
#result-box { height: 7em; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 0.5em; padding: 1pt; }
.justification { width: 50%; float: right; }
.justification-warn { width: 50%; float: right; background-color: #F0E442; }
.FOL-box, .simple-box { border: 1px solid black; border-radius: 3px; padding: 2px;}
.folproof-error { color: red; font-weight: bold; }
.lineno { display: block; float: left; width: 1.8em; }
.rule { clear: both; }
#examples { display: none; }
</style>
</head>
<body>
	<div class='container'>
		<div class='row'>
			<div class='col-md-12'>
				<h1>Proof Rondo</h1>
				<h4>Javascript First-Order Logic Proof Checker</h4>
				Source: <a href='https://github.com/hbasold/folproof-rondo' title='folproof-rondo on github'>https://github.com/hbasold/folproof-rondo</a>
				<div class='bs-callout bs-callout-info'>
					<h4>Instructions:</h4>
					<p>
						Enter your proof in the input box, below. As you type, the formatted proof
						will appear on the right, along with a validation status, beneath that. To learn
						the syntax, try playing with the examples, below, or see the
						<a href='{% link education/proof-rondo/language.md %}'>language reference.</a>
					</p>
					<p>
						<strong>Note:</strong> Please be sure you have a modern browser, and that
						Javascript is enabled.
					</p>
					<strong>Examples:<strong>
					<button class='examples' value='0'>Example 5.8</button>
					<button class='examples' value='1'>Example 3.1</button>
					<button class='examples' value='2'>Example 5.12</button>
					<button class='examples' value='3'>Drinkers Paradox</button>
				</div>
			</div>
		</div>
		<div class='row'>
			<div id='leftcol' class='col-md-6'>
				<textarea id='proof-input'>
1 A x.(P(x) -> ~Q(x))
2 | E x.(P(x) and Q(x))	    : assumption
  || with x0
3 || P(x0) and Q(x0)        : assumption
4 || P(x0)                  : and elim1 3
5 || P(x0) -> ~Q(x0)        : A.x/x0 elim 1
6 || ~Q(x0)                 : -> e 5,4
7 || Q(x0)                  : and elim2 3
8 || _|_                    : neg elim 6,7
   ---
9 | _|_                     : E.x/x0 elim 2,3-8
  ---
10 ~(E x. (P(x) and Q(x)))  : neg introduction 2-9
				</textarea>
			</div>
			<div id='rightcol' class='col-md-6'>
			</div>
			<div id='rightcol' class='col-md-6'>
				<div id='options'>
					<label>
						Parentheses:
						<select id='parentheses'>
							<option value='minimal'>Minimal (order-of-ops overrides)</option>
							<option value='user' selected='selected'>User-defined</option>
							<option value='explicit'>Explicit order-of-ops</option>
						</select>
					</label>
				</div>
				<div id='result-box' class='bs-callout bs-callout-warning'>
					<h4>Result:</h4>
					<div id='result'>
					</div>
				</div>
				<div id='render-panel' class='highlight'>
				</div>
			</div>
		</div>
</div>
<!-- these are hidden by CSS style rules... -->
<div id='examples'>
<div id='example0'>
1 ∀x.P(c, x)    : premise
| with x0
2 | P(c,x0)     : A.x/x0 e 1
3 | ∃y.P(y,x0)  : E.y/c i 2
4 ∀x.∃y.P(y,x)  : A.x/x0 i 2-3
</div>
<div id='example1'>
1 r and u -> w  : premise
2 u and ~w      : premise
3 | r
4 | u           : and e1 2
5 | r and u     : and i 3,4
6 | w           : -> e 1, 5
7 | ~w          : and e2 2
8 | ⊥           : neg e 6,7
9 ~r            : neg i 3-8
</div>
<div id='example2'>
# To use lemmas and previous results, you can include them as extra premises

¬(∃x.¬P(x)) → ∀x.¬¬P(x)  : premise example
¬(∀x.P(x))
| ¬(∃x.¬P(x))
| ∀x.¬¬P(x)    : -> e 1,3
|| with x0
|| ¬¬P(x0)     : A.x/x0 e 4
||| ¬P(x0)
||| ⊥          : neg e 5,6
|| P(x0)       : contra 6-7
| ∀x.P(x)      : A.x/x0 i 5-8
| ⊥            : neg e 2,9
∃x.¬P(x)       : contra 3-10
</div>
<div id='example3'>
¬(∀x.P(x) → D(x)) → (∃x. P(x) ∧ ¬D(x))
∃x.P(x)
(∀x.P(x) → D(x)) ∨ ¬(∀x.P(x) → D(x))       : lem
| ∀x.P(x) → D(x)
|| with x0
|| P(x0)
||| P(x0) ∧ D(x0)
||| ∀x.P(x) → D(x)                         : copy 4
|| (P(x0) ∧ D(x0) -> (∀x.P(x) → D(x)))     : -> i 6-7
|| (∃y. P(y) ∧ D(y) -> (∀x.P(x) → D(x)))   : E.y/x0 i 8
| (∃y. P(y) ∧ D(y) -> (∀x.P(x) → D(x)))    : E.x/x0 e 2, 5-9
------
| ¬(∀x.P(x) → D(x))
| (∃x. P(x) ∧ ¬D(x))                       : -> e 1, 11
|| with x0
|| P(x0) ∧ ¬D(x0)
||| P(x0) ∧ D(x0)
||| ¬D(x0)                                 : and e2 13
||| D(x0)                                  : and e2 14
||| ⊥                                      : neg e 15,16
||| ∀x.P(x) → D(x)                         : bot e 17
|| (P(x0) ∧ D(x0) -> (∀x.P(x) → D(x)))     : -> i 14-18
|| (∃y. P(y) ∧ D(y) -> (∀x.P(x) → D(x)))   : E.y/x0 i 19
| (∃y. P(y) ∧ D(y) -> (∀x.P(x) → D(x)))    : E.x/x0 e 12, 13-20
------
(∃y. P(y) ∧ D(y) -> (∀x.P(x) → D(x)))      : or e 3, 4-10, 11-21
</div>
</div>
</body>
</html>
